{% extends "base.html" %}

{% block title %}Quick Review - Azure AI-900 Study App{% endblock %}

{% block content %}
<div class="container my-4">
    <!-- Review Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-info text-white">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h1 class="card-title mb-2">
                                <i class="bi bi-bookmark-fill me-2"></i>
                                Quick Review & Key Concepts
                            </h1>
                            <p class="card-text mb-0">
                                Essential concepts and Azure services for the AI-900 exam
                            </p>
                        </div>
                        <div class="text-end">
                            <a href="{{ url_for('index') }}" class="btn btn-light">
                                <i class="bi bi-arrow-left me-1"></i>Back to Dashboard
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Navigation -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        <i class="bi bi-list-ul me-2"></i>Jump to Section
                    </h5>
                    <div class="d-flex flex-wrap gap-2">
                        {% if key_essentials.sections %}
                            {% for section in key_essentials.sections %}
                            <a href="#section-{{ loop.index0 }}" class="btn btn-outline-primary btn-sm">
                                {{ section.title }}
                            </a>
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Key Essentials Content -->
    {% if key_essentials.sections %}
        {% for section in key_essentials.sections %}
        <div class="row mb-4" id="section-{{ loop.index0 }}">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h4 class="mb-0">
                            <i class="bi bi-star-fill me-2"></i>
                            {{ section.title }}
                        </h4>
                    </div>
                    <div class="card-body">
                        <div class="content-section">
                            {{ section.content | markdown | safe }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="row">
            <div class="col-12">
                <div class="alert alert-warning" role="alert">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    Review content is being loaded. Please refresh the page in a moment.
                </div>
            </div>
        </div>
    {% endif %}

    <!-- Study Actions -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card bg-light">
                <div class="card-body text-center">
                    <h5 class="card-title">
                        <i class="bi bi-rocket-takeoff-fill text-primary me-2"></i>
                        Ready to Test Your Knowledge?
                    </h5>
                    <p class="card-text mb-3">
                        Use these tools to reinforce your learning and track your progress.
                    </p>
                    <div class="d-flex gap-2 justify-content-center flex-wrap">
                        <a href="{{ url_for('quiz', quiz_type='practice') }}" class="btn btn-success">
                            <i class="bi bi-question-circle-fill me-1"></i>Take Practice Quiz
                        </a>
                        {% for i in range(1, 6) %}
                        <a href="{{ url_for('study_topic', topic_num=i) }}" class="btn btn-outline-primary">
                            <i class="bi bi-book me-1"></i>Study Topic {{ i }}
                        </a>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Exam Tips -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card border-warning">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0">
                        <i class="bi bi-lightbulb-fill me-2"></i>
                        Last-Minute Exam Tips
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6>Before the Exam:</h6>
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Get 80%+ on practice tests consistently
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Review responsible AI principles thoroughly
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Memorize Azure AI service capabilities
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Understand ML types: regression, classification, clustering
                                </li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>During the Exam:</h6>
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Read questions carefully for key scenarios
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Eliminate obviously wrong answers first
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Flag difficult questions for review
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success me-2"></i>
                                    Focus on Azure-specific implementations
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Enhance table styling for server-rendered markdown
    document.querySelectorAll('.content-section table').forEach(table => {
        table.classList.add('table', 'table-striped', 'table-bordered', 'mt-3', 'mb-3');
    });
    
    // Enhance code blocks for server-rendered markdown
    document.querySelectorAll('.content-section code').forEach(code => {
        if (!code.parentElement.tagName === 'PRE') {
            code.classList.add('bg-light', 'p-1', 'rounded');
        }
    });
    
    // Add smooth scrolling for section navigation
    document.querySelectorAll('a[href^="#section-"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
                
                // Highlight the section briefly
                target.querySelector('.card').classList.add('border-primary');
                setTimeout(() => {
                    target.querySelector('.card').classList.remove('border-primary');
                }, 2000);
            }
        });
    });
    
    // Add search functionality
    function addSearchBar() {
        const searchHTML = `
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="input-group">
                                <span class="input-group-text">
                                    <i class="bi bi-search"></i>
                                </span>
                                <input type="text" class="form-control" id="searchInput" 
                                       placeholder="Search key concepts...">
                                <button class="btn btn-outline-secondary" type="button" onclick="clearSearch()">
                                    Clear
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        const firstRow = document.querySelector('.row.mb-4');
        if (firstRow && firstRow.nextElementSibling) {
            firstRow.nextElementSibling.insertAdjacentHTML('beforebegin', searchHTML);
            
            // Add search functionality
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', performSearch);
        }
    }
    
    function performSearch() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const sections = document.querySelectorAll('[id^="section-"]');
        
        sections.forEach(section => {
            const content = section.textContent.toLowerCase();
            if (searchTerm === '' || content.includes(searchTerm)) {
                section.style.display = 'block';
            } else {
                section.style.display = 'none';
            }
        });
        
        // Show "no results" message if needed
        const visibleSections = Array.from(sections).filter(s => s.style.display !== 'none');
        let noResultsMsg = document.getElementById('noResults');
        
        if (visibleSections.length === 0 && searchTerm !== '') {
            if (!noResultsMsg) {
                noResultsMsg = document.createElement('div');
                noResultsMsg.id = 'noResults';
                noResultsMsg.className = 'alert alert-info text-center';
                noResultsMsg.innerHTML = '<i class="bi bi-search me-2"></i>No results found. Try a different search term.';
                sections[0].parentNode.insertBefore(noResultsMsg, sections[0]);
            }
        } else if (noResultsMsg) {
            noResultsMsg.remove();
        }
    }
    
    function clearSearch() {
        document.getElementById('searchInput').value = '';
        performSearch();
    }
    
    // Initialize search bar after content loads
    setTimeout(addSearchBar, 1000);
</script>
{% endblock %} 